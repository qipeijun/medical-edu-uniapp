import{D as t,r as e,o as s,c as a,w as n,i as r,a as i,f as l,b as o,p as u,t as c,v as d,x as m,y as h,F as f,G as x,d as p,e as _,S as b,g as k}from"./index-4a91be04.js";import{u as C}from"./exam.baba227c.js";import{m as S}from"./questions.c06fdb8d.js";import{S as I}from"./StatusBar.adc84dda.js";import{a as w}from"./date.4f28c945.js";import{Q as y}from"./constants.90a8addf.js";import{_ as q}from"./_plugin-vue_export-helper.1b428a4d.js";const v=q({components:{StatusBar:I},data:()=>({examId:null,questions:[],currentIndex:0,answers:{},timeLeft:0,timer:null,showSheet:!1}),computed:{examStore:()=>C(),currentQuestion(){return this.questions[this.currentIndex]},totalCount(){return this.questions.length},progress(){return(this.currentIndex+1)/this.totalCount*100},isLast(){return this.currentIndex===this.totalCount-1},questionTypeName(){if(!this.currentQuestion)return"";const t=Object.values(y).find(t=>t.code===this.currentQuestion.type);return t?t.name:""}},onLoad(t){this.examId=t.id,this.examStore.setCurrentExam(this.examId),this.questions=S.slice(0,5),this.examStore.currentExam&&(this.timeLeft=60*this.examStore.currentExam.duration,this.startTimer())},methods:{startTimer(){this.timer=setInterval(()=>{this.timeLeft--,this.timeLeft<=0&&this.submitExam(!0)},1e3)},formatTime:t=>w(t),confirmExit(){t({title:"æç¤º",content:"é€€å‡ºåŽè€ƒè¯•å°†ç»“æŸï¼Œç¡®å®šè¦é€€å‡ºå—?",success:t=>{t.confirm&&this.submitExam()}})},isSelected(t){const e=this.answers[this.currentQuestion.id];return Array.isArray(e)?e.includes(t.label):e===t.label},selectOption(t){this.answers[this.currentQuestion.id]=t.label},prevQuestion(){this.currentIndex>0&&this.currentIndex--},handleNext(){this.isLast?t({title:"æç¤º",content:"ç¡®å®šè¦äº¤å·å—?",success:t=>{t.confirm&&this.submitExam()}}):this.currentIndex++},jumpTo(t){this.currentIndex=t,this.showSheet=!1},submitExam(t=!1){clearInterval(this.timer);let s=0;this.questions.forEach(t=>{this.answers[t.id]===t.correctAnswer&&s++});const a=Math.round(s/this.totalCount*100);this.examStore.submitExam({examId:this.examId,score:a,answers:this.answers,timeSpent:60*this.examStore.currentExam.duration-this.timeLeft}),e({url:`/pages/exam/result?score=${a}&total=${this.totalCount}&correct=${s}`})}},onUnload(){this.timer&&clearInterval(this.timer)}},[["render",function(t,e,C,S,I,w){const y=p("StatusBar"),q=_,v=r,E=b,Q=k;return s(),a(v,{class:"page"},{default:n(()=>[i(y),l(" Header "),i(v,{class:"header"},{default:n(()=>[i(v,{class:"back-btn",onClick:w.confirmExit},{default:n(()=>[i(q,{class:"back-icon"},{default:n(()=>[o("â†")]),_:1})]),_:1},8,["onClick"]),i(q,{class:"title"},{default:n(()=>[o("è€ƒè¯•ä¸­")]),_:1}),i(v,{class:u(["timer",{warning:I.timeLeft<300}])},{default:n(()=>[i(q,null,{default:n(()=>[o("â° "+c(w.formatTime(I.timeLeft)),1)]),_:1})]),_:1},8,["class"])]),_:1}),l(" Question Area "),w.currentQuestion?(s(),a(E,{key:0,class:"content","scroll-y":""},{default:n(()=>[i(v,{class:"progress-bar"},{default:n(()=>[i(v,{class:"fill",style:d({width:w.progress+"%"})},null,8,["style"])]),_:1}),i(v,{class:"question-header"},{default:n(()=>[i(q,{class:"q-type"},{default:n(()=>[o(c(w.questionTypeName),1)]),_:1}),i(q,{class:"q-index"},{default:n(()=>[o("ç¬¬ "+c(I.currentIndex+1)+" / "+c(w.totalCount)+" é¢˜",1)]),_:1})]),_:1}),i(v,{class:"question-text"},{default:n(()=>[o(c(w.currentQuestion.content),1)]),_:1}),i(v,{class:"options-list"},{default:n(()=>[(s(!0),m(f,null,h(w.currentQuestion.options,t=>(s(),a(v,{class:u(["option-item",{selected:w.isSelected(t)}]),key:t.label,onClick:e=>w.selectOption(t)},{default:n(()=>[i(v,{class:"opt-label"},{default:n(()=>[o(c(t.label),1)]),_:2},1024),i(q,{class:"opt-text"},{default:n(()=>[o(c(t.text),1)]),_:2},1024)]),_:2},1032,["class","onClick"]))),128))]),_:1}),i(v,{class:"footer-spacer"})]),_:1})):l("v-if",!0),l(" Footer "),i(v,{class:"footer"},{default:n(()=>[i(v,{class:"sheet-btn",onClick:e[0]||(e[0]=t=>I.showSheet=!0)},{default:n(()=>[i(q,null,{default:n(()=>[o("ðŸ“„ ç­”é¢˜å¡")]),_:1})]),_:1}),i(v,{class:"actions"},{default:n(()=>[i(Q,{class:"btn-prev",onClick:w.prevQuestion,disabled:0===I.currentIndex},{default:n(()=>[o("ä¸Šä¸€é¢˜")]),_:1},8,["onClick","disabled"]),i(Q,{class:"btn-next",onClick:w.handleNext},{default:n(()=>[o(c(w.isLast?"äº¤å·":"ä¸‹ä¸€é¢˜"),1)]),_:1},8,["onClick"])]),_:1})]),_:1}),l(" Answer Sheet Modal "),I.showSheet?(s(),a(v,{key:1,class:"modal-mask",onClick:e[3]||(e[3]=t=>I.showSheet=!1)},{default:n(()=>[i(v,{class:"modal-content",onClick:e[2]||(e[2]=x(()=>{},["stop"]))},{default:n(()=>[i(v,{class:"sheet-header"},{default:n(()=>[i(q,null,{default:n(()=>[o("ç­”é¢˜å¡")]),_:1}),i(q,{class:"close",onClick:e[1]||(e[1]=t=>I.showSheet=!1)},{default:n(()=>[o("âœ•")]),_:1})]),_:1}),i(E,{class:"sheet-grid","scroll-y":""},{default:n(()=>[(s(!0),m(f,null,h(I.questions,(t,e)=>(s(),a(v,{class:u(["sheet-item",{answered:I.answers[t.id],current:e===I.currentIndex}]),key:t.id,onClick:t=>w.jumpTo(e)},{default:n(()=>[o(c(e+1),1)]),_:2},1032,["class","onClick"]))),128))]),_:1})]),_:1})]),_:1})):l("v-if",!0)]),_:1})}],["__scopeId","data-v-77822b87"]]);export{v as default};
